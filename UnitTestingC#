ManualUnitTesting



Program.cs

using System;

namespace ManualUnitTesting
{
    class Program
    {
        static int Add(int a, int b) => a + b;

        static void Main()
        {
            Console.WriteLine("Testing Add Method");
            Console.WriteLine(Add(2, 3) == 5 ? "Pass" : "Fail");
        }
    }
}







MS Tests:

Attribute
Purpose
[TestClass]
Marks a class as containing test methods.
[TestMethod]
Marks a method as a test.
[DataTestMethod]
Marks a method for data-driven testing.
[DataRow]
Provides input data for [DataTestMethod].
[TestInitialize]
Runs code before each test method.
[TestCleanup]
Runs code after each test method.
[ClassInitialize]
Runs once before all tests in the class.
[ClassCleanup]
Runs once after all tests in the class.
[Ignore]
Skips a test method.
[ExpectedException]
Indicates that a specific exception is expected.



Method
Description
Assert.AreEqual
Verifies that two values are equal.
Assert.AreNotEqual
Verifies that two values are not equal.
Assert.IsTrue
Verifies that a condition is true.
Assert.IsFalse
Verifies that a condition is false.
Assert.IsNull
Verifies that an object is null.
Assert.IsNotNull
Verifies that an object is not null.
Assert.ThrowsException
Verifies that a specific exception is thrown.






Create a MSTest Project in VS2022 : MSTestPrj
Create a static class to be tested: Calculator.cs
Calculator
Create the test classes: CalculatorTests.cs
CalculatorTests
CalculatorTests2
TestLifecycleExample
Build the Project
Go to top level Menu  -> Test -> Test Explorer
If the project is already build, we can see all tests here
Run or debug the tests to check them.





Calculator.cs

using System;

namespace MSTestPrj
{
    public static class Calculator
    {
        public static int Add(int a, int b) => a + b;
        public static int Subtract(int a, int b) => a - b;
    }

}






CalculatorTests.cs

using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace MSTestPrj
{

    [TestClass]
    public class CalculatorTests
    {
        [TestMethod]
        public void Add_ShouldReturnCorrectSum()
        {
            int result = Calculator.Add(2, 3);
            Assert.AreEqual(5, result);
        }

        [TestMethod]
        public void Subtract_ShouldReturnCorrectDifference()
        {
            int result = Calculator.Subtract(5, 3);
            Assert.AreEqual(2, result);
        }
    }
    
    [TestClass]
    public class CalculatorTests2
    {
        [DataTestMethod]
        [DataRow(2, 3, 5)]
        [DataRow(-1, 1, 0)]
        [DataRow(0, 0, 0)]
        public void Add_ShouldReturnCorrectSum(int a, int b, int expected)
        {
            int result = Calculator.Add(a, b);
            Assert.AreEqual(expected, result);
        }
    }


    [TestClass]
    public class TestLifecycleExample
    {
        [ClassInitialize]
        public static void ClassInit(TestContext context)
        {
            // Runs once before all tests
        }

        [TestInitialize]
        public void TestInit()
        {
            // Runs before each test
        }

        [TestMethod]
        public void TestExample()
        {
            Assert.IsTrue(true);
        }

        [TestCleanup]
        public void TestCleanup()
        {
            // Runs after each test
        }

        [ClassCleanup]
        public static void ClassCleanup()
        {
            // Runs once after all tests
        }

        [TestMethod]
        public void AssertionsExample()
        {
            Assert.AreEqual(5, Calculator.Add(2, 3));
            int x = 0;
            Assert.ThrowsException<DivideByZeroException>(() => { int result = 1 / x; });
        }
    }
}







using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace MSTestPrj
{

    [TestClass]
    public class CalculatorTests
    {
        [TestMethod]
        public void Add_ShouldReturnCorrectSum()
        {
            int result = Calculator.Add(2, 3);
            Assert.AreEqual(5, result);
        }

        [TestMethod]
        public void Subtract_ShouldReturnCorrectDifference()
        {
            int result = Calculator.Subtract(5, 3);
            Assert.AreEqual(2, result);
        }
    }

    [TestClass]
    public class CalculatorTests2
    {
        [DataTestMethod]
        [DataRow(2, 3, 5)]
        [DataRow(-1, 1, 0)]
        [DataRow(0, 0, 0)]
        public void Add_ShouldReturnCorrectSum(int a, int b, int expected)
        {
            int result = Calculator.Add(a, b);
            Assert.AreEqual(expected, result);
        }
    }


    [TestClass]
    public class TestLifecycleExample
    {
        [ClassInitialize]
        public static void ClassInit(TestContext context)
        {
            Console.WriteLine("ClassInit: Before all tests");
        }

        [TestInitialize]
        public void TestInit()
        {
            Console.WriteLine("TestInit: Before each tests");
        }

        [TestMethod]
        public void TestExample()
        {
            Assert.IsTrue(true);
        }

        [TestCleanup]
        public void TestCleanup()
        {
            Console.WriteLine("TestCleanup: Post each tests");
        }

        [ClassCleanup]
        public static void ClassCleanup()
        {
            Console.WriteLine("ClassCleanup: Post all tests");
        }

        [TestMethod]
        public void AssertionsExample()
        {
            Assert.AreEqual(5, Calculator.Add(2, 3));
            int x = 0;
            Assert.ThrowsException<DivideByZeroException>(() => { int result = 1 / x; });
        }
    }
}









